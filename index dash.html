<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal Hafazan SMKATB</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

    <style>
        body { font-family: 'Poppins', sans-serif; background-color: #f0f2f5; }
        .hero-section { background: linear-gradient(135deg, #1e5128, #4e944f); color: white; padding: 60px 0; border-bottom-left-radius: 50px; border-bottom-right-radius: 50px; }
        .search-card { margin-top: -50px; border: none; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .result-card { display: none; border: none; border-radius: 20px; margin-top: 20px; animation: fadeIn 0.5s; }
        .status-badge { padding: 8px 15px; border-radius: 50px; font-size: 0.8rem; font-weight: 600; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="hero-section text-center">
    <h1>Portal E-Hafazan</h1>
    <p>Semakan Prestasi Hafazan Pelajar SMKATB</p>
</div>

<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <div class="card search-card p-4">
                <div class="mb-3">
                    <label class="form-label fw-bold">No. Kad Pengenalan Pelajar</label>
                    <input type="text" id="icInput" class="form-control form-control-lg" placeholder="Contoh: 091022031234" maxlength="12">
                </div>
                <button onclick="cariPelajar()" class="btn btn-success btn-lg w-100 shadow-sm">Semak Sekarang</button>
            </div>

            <div id="resultArea" class="card result-card p-4 shadow mb-5">
                <h4 class="text-success fw-bold mb-3">Keputusan Ditemui</h4>
                <table class="table table-borderless">
                    <tr>
                        <td class="text-muted">Nama Pelajar</td>
                        <td id="resNama" class="fw-bold text-end">-</td>
                    </tr>
                    <tr>
                        <td class="text-muted">Kelas</td>
                        <td id="resKelas" class="text-end">-</td>
                    </tr>
                </table>
                <hr>
                <div class="bg-light p-3 rounded-3 mb-3">
                    <small class="text-muted d-block">Pencapaian Semasa</small>
                    <span id="resSurah" class="h5 fw-bold text-dark">-</span>
                </div>
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <small class="text-muted d-block">Status</small>
                        <span id="resStatus" class="status-badge bg-success text-white">LANCAR</span>
                    </div>
                    <div class="text-end">
                        <small class="text-muted d-block">Gred</small>
                        <span id="resGred" class="h4 fw-bold text-primary">A</span>
                    </div>
                </div>
                <button onclick="window.print()" class="btn btn-outline-secondary btn-sm mt-4">Cetak Slip</button>
            </div>
        </div>
    </div>
</div>

<script>
    // GANTI PAUTAN INI DENGAN CSV DARI GOOGLE SHEETS ANDA
    const csvURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQd8KR9lDaJaaU5Ba_m-AtrsSxFXJXdPHzjGCbN8rH0dcwbRp1lQ5GaoNHI_cQpKejriavr2Ycj9-h9/pub?gid=1591484628&single=true&output=csv';

    function cariPelajar() {
        const inputIC = document.getElementById('icInput').value;
        if(inputIC === "") { alert("Sila masukkan No. IC!"); return; }

        Papa.parse(csvURL, {
            download: true,
            header: true,
            complete: function(results) {
                const data = results.data;
                const p = data.find(row => row.IC === inputIC);

                if (p) {
                    document.getElementById('resNama').innerText = p.Nama;
                    document.getElementById('resKelas').innerText = p.Kelas;
                    document.getElementById('resSurah').innerText = p.Surah;
                    document.getElementById('resStatus').innerText = p.Status;
                    document.getElementById('resGred').innerText = p.Gred;
                    document.getElementById('resultArea').style.display = 'block';
                } else {
                    alert("Maaf, rekod tidak ditemui. Sila semak No. IC.");
                    document.getElementById('resultArea').style.display = 'none';
                }
            }
        });
    }
</script>

</body>
</html>